<!DOCTYPE html>
<html>
  <head>
    <title>Embedding Vega-Lite</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.3.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@3.1.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@4.0.0"></script>
  </head>

  <body>
    <div id="medicareVis"></div>

    <script type="text/javascript">
      var statesMedicareViz = {
        "data": {"url": "data/medicare.csv"},
        "vconcat": [
          {
            "selection": {"brush": {"type": "interval", "encodings": ["x"]}},
            "mark": "rect",
            "encoding": {
              "x": {
                "field": "State name", 
                "type": "nominal"
              },
              "color": { 
                "condition": {
                  "selection": "brush",
                  "field": "Medicare enrollees (2014)", 
                  "type": "quantitative"
                },
                "value": "grey"
              }
            }
          },
          {
            "hconcat": [
              {
                "layer": [
                  {
                    "selection": {"biBrush": {"type": "interval"}},
                    "transform": [{"filter": {"selection": "brush"}}],
                    "mark": {
                      "type": "line", 
                      "color": "#85C5A6", 
                      "point": {"fill": "#85C5A6"}
                    },
                    "encoding": {
                      "x": {
                        "field": "State name",
                        "type": "nominal"
                      },
                      "y": {
                        "field": "Total Medicare reimbursements per enrollee - ASR",
                        "type": "quantitative",
                        "axis": {
                          "title": "Total Medicare reimbursements per enrollee - ASR", 
                          "titleColor":"#85C5A6"
                        },
                        "opacity": {"value": 0.9}
                      }
                    }
                  },
                  {
                    "transform": [{"filter": {"selection": "brush"}}],
                    "mark": {"type": "line", "point": true},
                    "encoding": {
                      "x": {
                        "field": "State name",
                        "type": "nominal"
                      },
                      "y": {
                        "field": "Total Medicare reimbursements per enrollee - PASR",
                        "type": "quantitative",
                        "axis": {
                          "title": "Total Medicare reimbursements per enrollee - PASR", 
                          "titleColor":"#85A9C5"
                        }
                      },
                      "opacity": {"value": 0.9}
                    }
                  }
                ],
                "resolve": {"scale": {"y": "independent"}}
              }
            ]
          },
          {
            "hconcat": [
              {
                "layer": [
                  {
                    "transform": [
                      {"filter": {"selection": "brush"}},
                      {"filter": {"selection": "biBrush"}}
                    ],
                    "mark": {"type": "point", "color": "#e7ba52"},
                    "encoding":{
                      "x": {"field": "State name", "type": "nominal"},
                      "y": {
                        "field": "Hospital & skilled nursing facility reimbursements per enrollee - ASR", 
                        "type": "quantitative",
                        "axis": {
                          "title": "All kinds - ASR"
                        }
                      }
                    }
                  },
                  {
                    "transform": [
                      {"filter": {"selection": "brush"}},
                      {"filter": {"selection": "biBrush"}}
                    ],
                    "mark": {"type": "point", "color": "#ff9896"},
                    "encoding":{
                      "x": {"field": "State name", "type": "nominal"},
                      "y": {"field": "Outpatient facility reimbursements per enrollee - ASR", "type": "quantitative"}
                    }
                  },
                  {
                    "transform": [
                      {"filter": {"selection": "brush"}},
                      {"filter": {"selection": "biBrush"}}
                    ],
                    "mark": {"type": "point", "color": "#aec7e8"},
                    "encoding":{
                      "x": {"field": "State name", "type": "nominal"},
                      "y": {"field": "Physician reimbursements per enrollee - ASR", "type": "quantitative"}
                    }
                  },
                  {
                    "transform": [
                      {"filter": {"selection": "brush"}},
                      {"filter": {"selection": "biBrush"}}
                    ],
                    "mark": {"type": "point", "color": "#1f77b4"},
                    "encoding":{
                      "x": {"field": "State name", "type": "nominal"},
                      "y": {"field": "Home health agency reimbursements per enrollee - ASR", "type": "quantitative"}
                    }
                  },
                  {
                    "transform": [
                      {"filter": {"selection": "brush"}},
                      {"filter": {"selection": "biBrush"}}
                    ],
                    "mark": {"type": "point", "color": "#9467bd"},
                    "encoding":{
                      "x": {"field": "State name", "type": "nominal"},
                      "y": {"field": "Hospice reimbursements per enrollee - ASR", "type": "quantitative"}
                    }
                  },
                  {
                    "transform": [
                      {"filter": {"selection": "brush"}},
                      {"filter": {"selection": "biBrush"}}
                    ],
                    "mark": {"type": "point", "color": "#d3eeb4"},
                    "encoding":{
                      "x": {"field": "State name", "type": "nominal"},
                      "y": {"field": "Durable medical equipment reimbursements per enrollee - ASR", "type": "quantitative"}
                    }
                  }
                ]
              },
              {
                "mark": {"type":"point"},
                "encoding": {
                  "color": {
                    "field": "fields",
                    "type": "nominal",
                    "scale": {
                      "domain": [
                        "Hospital & skilled nursing facility reimbursements per enrollee",
                        "Outpatient facility reimbursements per enrollee",
                        "Physician reimbursements per enrollee",
                        "Home health agency reimbursements per enrollee",
                        "Hospice reimbursements per enrollee",
                        "Durable medical equipment reimbursements per enrollee"],
                      "range": ["#e7ba52","#ff9896","#aec7e8","#1f77b4","#9467bd", "#d3eeb4"]
                    },
                    "legend": {"title": "fields"}
                  }
                }
              }
            ]
          }
        ]
      }
      vegaEmbed('#medicareVis', statesMedicareViz);
    </script>
  </body>
  
</html>
